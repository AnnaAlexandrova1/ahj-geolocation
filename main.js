(()=>{"use strict";const t=new class{constructor(){this.container=document.querySelector(".container")}modalWindow(){const t=document.createElement("div");return t.classList.add("modal"),t.innerHTML='\n      <p>Что-то пошло не так. Нам не удалось определить ваше местоположение. \n        Пожалуйста, дайте разрещение на определение гопозиции \n        или введите координаты вручную</p>\n      \n        <p>Широта и долгота через запятую</p>\n\n        <input type="text" id="modal-coord" placeholder="Введите через запятую широту и долготу">\n        <div class="buttons">\n        <button class="btn-modal cancel">Отмена</button>\n        <button class="btn-modal send">Отправить</button>\n        <div>\n    ',t}bindToDom(){const t=this.modalWindow();this.container.appendChild(t)}removeModalWin(){const t=this.container.querySelector(".modal");this.container.removeChild(t)}},e=new class{constructor(t){this.modal=t,this.container=document.querySelector(".container"),this.board=document.querySelector(".board"),this.btnSend=document.querySelector(".btn-send"),this.btnAudio=document.querySelector(".btn-audio"),this.btnVideo=document.querySelector(".btn-video")}start(){this.btnSend.addEventListener("click",(t=>this.send(t)))}send(t){t.preventDefault(),this.inputMess=document.getElementById("input-mess");const e=this.inputMess.value;""!==e&&this.location().then((t=>{const n=document.createElement("div");n.classList.add("message");const s=t.coords.latitude.toFixed(5),o=t.coords.longitude.toFixed(5);n.innerHTML=`\n      <span>${this.getData()}</span>\n      <p>${e}<p>\n      <span>${o},-${s}</span>`,this.board.appendChild(n),this.inputMess.value=""})).catch((()=>{this.modal.bindToDom(),this.container.addEventListener("click",(t=>this.modalBtn(t)))}))}location(t){return new Promise(((e,n)=>{navigator.geolocation.getCurrentPosition(e,n,t)}))}getData(){const t=new Date,e=String(t.getDate()).padStart(2,"0"),n=String(t.getMonth()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${e}.${n}.${t.getFullYear()}, ${s}:${o}`}modalBtn(t){if(t.preventDefault(),t.target.classList.contains("cancel"))this.modal.removeModalWin();else if(t.target.classList.contains("send")){const t=document.querySelector("#modal-coord");this.editCoord(t.value)}}editCoord(t){t.trim();if(/^[-+]?([1-8]?\d(\.\d+)?|90(\.0+)?),\s*[-+]?(180(\.0+)?|((1[0-7]\d)|([1-9]?\d))(\.\d+)?)$/.test(t)){this.inputMess=document.getElementById("input-mess");const e=this.inputMess.value,n=document.createElement("div");n.classList.add("message"),n.innerHTML=`\n      <span>${this.getData()}</span>\n      <p>${e}<p>\n      <span>[${t}]</span>`,this.board.appendChild(n),this.inputMess.value="",this.modal.removeModalWin()}else{const t=document.createElement("div");t.classList.add("popover"),t.textContent="Не соответствует форме";document.querySelector(".modal").appendChild(t)}}testCoord(t){t.trim();return!!/^[-+]?([1-8]?\d(\.\d+)?|90(\.0+)?),\s*[-+]?(180(\.0+)?|((1[0-7]\d)|([1-9]?\d))(\.\d+)?)$/.test(t)}}(t);e.start()})();